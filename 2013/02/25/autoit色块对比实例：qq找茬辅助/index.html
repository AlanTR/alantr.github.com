<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>【转】Autoit色块对比实例：QQ找茬辅助 | 乌鸦的小木屋</title>
  <meta name="author" content="AlanTR">
  
  <meta name="description" content="你想发财吗?你想一夜成名么?你想交桃花运吗?你想永葆青春吗?别做梦了。好好学习吧!">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <link href="http://vjs.zencdn.net/c/video-js.css" rel="stylesheet">
  <script src="http://vjs.zencdn.net/c/video.js"></script>

  <script src="/audiojs/audio.min.js"></script>

  <meta property="og:title" content="【转】Autoit色块对比实例：QQ找茬辅助"/>
  <meta property="og:site_name" content="乌鸦的小木屋"/>

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="乌鸦的小木屋" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-38467519-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">乌鸦的小木屋</a></h1>
  <h2><a href="/">努力学习……啊啊啊好多不会的！</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="https://github.com/AlanTR">Github</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">

<article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-02-25T01:00:44.000Z"><a href="/2013/02/25/autoit色块对比实例：qq找茬辅助/">Feb 25 2013</a></time>
      
      
  
    <h1 class="title">【转】Autoit色块对比实例：QQ找茬辅助</h1>
  

    </header>
    <div class="entry">
      
        <p>什么是Autoit？</p>
<notextile><blockquote><p><a href="http://www.autoitscript.com/site/autoit/">Autoit</a>是一种自动控制工具。它可以被用来自动完成任何基于 Windows 或 DOS 的简单任务。它最初被设计用来自动完成安装那些其它方
法不能自动安装的软件。这在PC首次展示时非常有用，那时成百上千的机器需要被自动的安装。尽管有一些程序如 MS Office, Mcafee, IE4 等具有自动安装的组件，可还有太多的程序不具备自动安装的功能。那就是用到 AutoIt 的地方。AutoIt 也可以被用来在你的机器上完成简单
的任务。</p>
<footer></footer></blockquote></notextile>

<p>是不是有点罗嗦了？那咱换个方式 - -
<span id="more"></span></p>
<notextile><blockquote><p>它可以用来创建Microsoft Windows中的工具软件来自动执行常见的任务，例如监视网站，监视网络，磁盘碎片整理以及备份。它还能用来模拟
用户的操作，因此在软件测试中可以使用AutoIt代替手动来“驱动”应用程序。它还常用来开发计算机游戏机器人，用来自动执行游戏中的任务。</p>
<footer></footer></blockquote></notextile>

<p>其实有时候知道它能干嘛就够了，<a href="http://zh.wikipedia.org/zh/AutoIt#.E7.94.A8.E6.B3.95">Wiki</a>上的东西足够详细也足够精简。</p>
<p>昨晚上逛论坛的时候发现<a href="http://www.autoitx.com/space.php?uid=7653399">komaau3</a>写的一份以色块对比的为基础的QQ美女找茬辅助，果断下载下来学习一下。原理大概就是截取游戏窗口(
窗口?用句柄激活呗)中的起始点坐标+图片大小确认的图片，将图片转换为数组，再依据正则表达式来进行对比。将结果输出在界面上，然后Dll
Call user32.dll 来实现将鼠标点击传到游戏窗口的目的。</p>
<p>小小改了一下，弄了一个QQ大家来找茬的版本，原作者的版本只能在QQ美女找茬里运行。</p>
<p>其实我接触Autoit也没多久，于是对原作者的运行方式是不是这么解读很怀疑 @_@</p>
<p>贴上代码备用：</p>
<figure class="highlight"><figcaption><span>QQ美女找茬 </span><a href="http://www.autoitx.com/thread-37444-1-1.html">原帖地址</a></figcaption><table><tr><td class="gutter"><pre><code><div class="line-number">1</div><div class="line-number">2</div><div class="line-number">3</div><div class="line-number">4</div><div class="line-number">5</div><div class="line-number">6</div><div class="line-number">7</div><div class="line-number">8</div><div class="line-number">9</div><div class="line-number">10</div><div class="line-number">11</div><div class="line-number">12</div><div class="line-number">13</div><div class="line-number">14</div><div class="line-number">15</div><div class="line-number">16</div><div class="line-number">17</div><div class="line-number">18</div><div class="line-number">19</div><div class="line-number">20</div><div class="line-number">21</div><div class="line-number">22</div><div class="line-number">23</div><div class="line-number">24</div><div class="line-number">25</div><div class="line-number">26</div><div class="line-number">27</div><div class="line-number">28</div><div class="line-number">29</div><div class="line-number">30</div><div class="line-number">31</div><div class="line-number">32</div><div class="line-number">33</div><div class="line-number">34</div><div class="line-number">35</div><div class="line-number">36</div><div class="line-number">37</div><div class="line-number">38</div><div class="line-number">39</div><div class="line-number">40</div><div class="line-number">41</div><div class="line-number">42</div><div class="line-number">43</div><div class="line-number">44</div><div class="line-number">45</div><div class="line-number">46</div><div class="line-number">47</div><div class="line-number">48</div><div class="line-number">49</div><div class="line-number">50</div><div class="line-number">51</div><div class="line-number">52</div><div class="line-number">53</div><div class="line-number">54</div><div class="line-number">55</div><div class="line-number">56</div><div class="line-number">57</div><div class="line-number">58</div><div class="line-number">59</div><div class="line-number">60</div><div class="line-number">61</div><div class="line-number">62</div><div class="line-number">63</div><div class="line-number">64</div><div class="line-number">65</div><div class="line-number">66</div><div class="line-number">67</div><div class="line-number">68</div><div class="line-number">69</div><div class="line-number">70</div><div class="line-number">71</div><div class="line-number">72</div><div class="line-number">73</div><div class="line-number">74</div><div class="line-number">75</div><div class="line-number">76</div><div class="line-number">77</div><div class="line-number">78</div><div class="line-number">79</div><div class="line-number">80</div><div class="line-number">81</div><div class="line-number">82</div><div class="line-number">83</div><div class="line-number">84</div><div class="line-number">85</div><div class="line-number">86</div><div class="line-number">87</div><div class="line-number">88</div><div class="line-number">89</div><div class="line-number">90</div><div class="line-number">91</div><div class="line-number">92</div><div class="line-number">93</div><div class="line-number">94</div><div class="line-number">95</div><div class="line-number">96</div><div class="line-number">97</div><div class="line-number">98</div><div class="line-number">99</div><div class="line-number">100</div><div class="line-number">101</div><div class="line-number">102</div><div class="line-number">103</div><div class="line-number">104</div><div class="line-number">105</div><div class="line-number">106</div><div class="line-number">107</div><div class="line-number">108</div><div class="line-number">109</div><div class="line-number">110</div><div class="line-number">111</div><div class="line-number">112</div><div class="line-number">113</div><div class="line-number">114</div><div class="line-number">115</div><div class="line-number">116</div><div class="line-number">117</div><div class="line-number">118</div><div class="line-number">119</div><div class="line-number">120</div><div class="line-number">121</div><div class="line-number">122</div><div class="line-number">123</div><div class="line-number">124</div><div class="line-number">125</div><div class="line-number">126</div><div class="line-number">127</div><div class="line-number">128</div><div class="line-number">129</div><div class="line-number">130</div><div class="line-number">131</div><div class="line-number">132</div><div class="line-number">133</div><div class="line-number">134</div><div class="line-number">135</div><div class="line-number">136</div><div class="line-number">137</div><div class="line-number">138</div><div class="line-number">139</div><div class="line-number">140</div><div class="line-number">141</div></code></pre></td><td class="code"><pre><code><div class="line">;<span class="comment">#Include &lt;GDIPlus.au3&gt;</span></div><div class="line"><span class="comment">#include &lt;ScreenCapture.au3&gt;</span></div><div class="line">;<span class="comment">#Include &lt;Array.au3&gt;</span></div><div class="line"><span class="comment">#include &lt;GUIConstantsEx.au3&gt;</span></div><div class="line"><span class="comment">#include &lt;WindowsConstants.au3&gt;</span></div><div class="line"> </div><div class="line"><span class="variable">$Form1</span> = GUICreate(<span class="string">"QQ找茬助手 by aopo"</span>, <span class="number">495</span>, <span class="number">445</span>, -<span class="number">1</span>, -<span class="number">1</span>)</div><div class="line"><span class="variable">$Button1</span> = GUICtrlCreateButton(<span class="string">"找"</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">25</span>)</div><div class="line"><span class="variable">$Pic1</span> = GUICtrlCreatePic(<span class="string">""</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">495</span>, <span class="number">445</span>)</div><div class="line">GUISetState(@SW_SHOW)</div><div class="line"> </div><div class="line">WinSetOnTop(<span class="variable">$Form1</span>, <span class="string">""</span>, <span class="number">1</span>)</div><div class="line"> </div><div class="line">_GDIPlus_Startup()</div><div class="line"> </div><div class="line"><span class="keyword">While</span> <span class="number">1</span></div><div class="line">        <span class="variable">$nMsg</span> = GUIGetMsg()</div><div class="line">        <span class="keyword">Switch</span> <span class="variable">$nMsg</span></div><div class="line">                <span class="keyword">Case</span> <span class="variable">$GUI_EVENT_CLOSE</span></div><div class="line">                        _GDIPlus_Shutdown()</div><div class="line">                        <span class="keyword">Exit</span></div><div class="line">                <span class="keyword">Case</span> <span class="variable">$Button1</span></div><div class="line">                        GUISetState(@SW_HIDE, <span class="variable">$Form1</span>);由于采用的前台截图，所以先隐藏下窗口</div><div class="line">                        <span class="variable">$t</span> = TimerInit()</div><div class="line">                        getMap1()</div><div class="line">                        WinSetTitle(<span class="variable">$Form1</span>, <span class="string">""</span>, <span class="string">"本次找茬耗时:"</span> &amp; Round(TimerDiff(<span class="variable">$t</span>) / <span class="number">1000</span>, <span class="number">2</span>) &amp; <span class="string">"秒"</span>)</div><div class="line">                        GUISetState(@SW_SHOW, <span class="variable">$Form1</span>)</div><div class="line">                <span class="keyword">Case</span> <span class="variable">$Pic1</span></div><div class="line">                        Local <span class="variable">$hWnd</span> = WinGetHandle(<span class="string">"大家来找茬"</span>)</div><div class="line">                        Opt(<span class="string">"MouseCoordMode"</span>, <span class="number">2</span>);相对客户区</div><div class="line">                        Local <span class="variable">$aPos</span> = MouseGetPos();获取相对坐标</div><div class="line">                        ConsoleWrite(<span class="variable">$aPos</span>[<span class="number">0</span>] &amp; <span class="string">","</span> &amp; <span class="variable">$aPos</span>[<span class="number">1</span>] &amp; @CRLF)</div><div class="line">                        _MouseClick(<span class="variable">$hWnd</span>, <span class="variable">$aPos</span>[<span class="number">0</span>]+<span class="number">10</span>, <span class="variable">$aPos</span>[<span class="number">1</span>]+<span class="number">195</span>);转换到找茬窗口的坐标</div><div class="line">        <span class="keyword">EndSwitch</span></div><div class="line">WEnd</div><div class="line"> </div><div class="line">Func getMap1()</div><div class="line">        Local <span class="variable">$hWnd</span> = WinGetHandle(<span class="string">"大家来找茬"</span>)</div><div class="line">        <span class="keyword">If</span> Not IsHWnd(<span class="variable">$hWnd</span>) Then <span class="keyword">Return</span></div><div class="line">        WinActivate(<span class="variable">$hWnd</span>)</div><div class="line">        <span class="variable">$hBitmap</span> = _ScreenCapture_CaptureWnd(<span class="string">""</span>, <span class="variable">$hWnd</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="keyword">False</span>)</div><div class="line">        <span class="variable">$hImage</span> = _GDIPlus_BitmapCreateFromHBITMAP(<span class="variable">$hBitmap</span>)</div><div class="line">        ;_GDIPlus_ImageSaveToFile(<span class="variable">$hImage</span>, @ScriptDir &amp; <span class="string">"\原图.bmp"</span>)</div><div class="line">        </div><div class="line">        ;<span class="variable">$hImage</span> = _GDIPlus_ImageLoadFromFile(@ScriptDir &amp; <span class="string">"\原图.bmp"</span>);使用本地图片测试</div><div class="line"> </div><div class="line">        <span class="variable">$hClone1</span> = _GDIPlus_BitmapCloneArea(<span class="variable">$hImage</span>, <span class="number">10</span>, <span class="number">195</span>, <span class="number">495</span>, <span class="number">445</span>)</div><div class="line">        ;_GDIPlus_ImageSaveToFile(<span class="variable">$hClone1</span>, @ScriptDir &amp; <span class="string">"\111111.bmp"</span>)</div><div class="line">        Local <span class="variable">$aMap1</span> = Bitmap2Array(<span class="variable">$hClone1</span>)</div><div class="line"> </div><div class="line">        <span class="variable">$hClone2</span> = _GDIPlus_BitmapCloneArea(<span class="variable">$hImage</span>, <span class="number">519</span>, <span class="number">195</span>, <span class="number">495</span>, <span class="number">445</span>)</div><div class="line">        ;_GDIPlus_ImageSaveToFile(<span class="variable">$hClone2</span>, @ScriptDir &amp; <span class="string">"\222222.bmp"</span>)</div><div class="line">        Local <span class="variable">$aMap2</span> = Bitmap2Array(<span class="variable">$hClone2</span>)</div><div class="line"> </div><div class="line">        ;GUICtrlSetImage(<span class="variable">$Pic1</span>, @ScriptDir &amp; <span class="string">"\111111.bmp"</span>)</div><div class="line">        <span class="variable">$hGraphic</span> = _GDIPlus_ImageGetGraphicsContext(<span class="variable">$hClone1</span>)</div><div class="line">        <span class="variable">$hPen</span> = _GDIPlus_PenCreate(<span class="number">0xFFFF0000</span>, <span class="number">2</span>)</div><div class="line">        Local <span class="variable">$aMatch1</span>, <span class="variable">$aMatch2</span>, <span class="variable">$iX</span>, <span class="variable">$iY</span>, <span class="variable">$iW</span>, <span class="variable">$iH</span></div><div class="line">        <span class="variable">$iH</span> = UBound(<span class="variable">$aMap1</span>)</div><div class="line">        <span class="keyword">For</span> <span class="variable">$iY</span> = <span class="number">0</span> To <span class="variable">$iH</span> - <span class="number">1</span> Step <span class="number">5</span>;找茬颜色对比无需太严格，每次<span class="number">5</span>行像素对比一次</div><div class="line">                <span class="keyword">If</span> <span class="variable">$aMap1</span>[<span class="variable">$iY</span>] &lt;&gt; <span class="variable">$aMap2</span>[<span class="variable">$iY</span>] Then</div><div class="line">                        <span class="variable">$aMatch1</span> = StringRegExp(<span class="variable">$aMap1</span>[<span class="variable">$iY</span>], <span class="string">"\w{6}"</span>, <span class="number">3</span>);大图处理正则效率明显提高了很多</div><div class="line">                        <span class="keyword">If</span> @error Then ContinueLoop</div><div class="line">                        <span class="variable">$aMatch2</span> = StringRegExp(<span class="variable">$aMap2</span>[<span class="variable">$iY</span>], <span class="string">"\w{6}"</span>, <span class="number">3</span>)</div><div class="line">                        <span class="keyword">If</span> @error Then ContinueLoop</div><div class="line">                        <span class="variable">$iW</span> = UBound(<span class="variable">$aMatch1</span>)</div><div class="line">                        <span class="keyword">For</span> <span class="variable">$iX</span> = <span class="number">0</span> To <span class="variable">$iW</span> - <span class="number">1</span> Step <span class="number">10</span>;每行每<span class="number">10</span>像素对比一次，提高对比速度</div><div class="line">                                <span class="keyword">If</span> <span class="variable">$aMatch1</span>[<span class="variable">$iX</span>] == <span class="variable">$aMatch2</span>[<span class="variable">$iX</span>] Then ContinueLoop</div><div class="line">                                _GDIPlus_GraphicsDrawLine(<span class="variable">$hGraphic</span>, <span class="variable">$iX</span>, <span class="variable">$iY</span> + <span class="number">1</span>, <span class="variable">$iX</span> + <span class="number">5</span>, <span class="variable">$iY</span> + <span class="number">1</span>, <span class="variable">$hPen</span>)</div><div class="line">                        Next</div><div class="line">                <span class="keyword">EndIf</span></div><div class="line">        Next</div><div class="line">        _GDIPlus_ImageSaveToFile(<span class="variable">$hClone1</span>, @TempDir &amp; <span class="string">"\111111.bmp"</span>)</div><div class="line">        GUICtrlSetImage(<span class="variable">$Pic1</span>, @TempDir &amp; <span class="string">"\111111.bmp"</span>)</div><div class="line">        _GDIPlus_PenDispose(<span class="variable">$hPen</span>)</div><div class="line">        _GDIPlus_GraphicsDispose(<span class="variable">$hGraphic</span>)</div><div class="line">        _GDIPlus_ImageDispose(<span class="variable">$hClone1</span>)</div><div class="line">        _GDIPlus_ImageDispose(<span class="variable">$hClone2</span>)</div><div class="line">        _GDIPlus_ImageDispose(<span class="variable">$hImage</span>)</div><div class="line">EndFunc   ;==&gt;getMap1</div><div class="line"> </div><div class="line">;ShellExecute(@ScriptDir &amp; <span class="string">"\111111.bmp"</span>)</div><div class="line">;ShellExecute(@ScriptDir &amp; <span class="string">"\222222.bmp"</span>)</div><div class="line"> </div><div class="line">Func Bitmap2Array(<span class="variable">$h_Bitmap</span>, <span class="variable">$b_Array2d</span> = <span class="keyword">False</span>)</div><div class="line">        Local <span class="variable">$t_BITMAPDATA</span>, <span class="variable">$p_Scan</span>, <span class="variable">$i_Stride</span>, <span class="variable">$t_PIXEDATA</span>, <span class="variable">$s_PIXEDATA</span></div><div class="line">        <span class="variable">$i_Width</span> = _GDIPlus_ImageGetWidth(<span class="variable">$h_Bitmap</span>)</div><div class="line">        <span class="variable">$i_Height</span> = _GDIPlus_ImageGetHeight(<span class="variable">$h_Bitmap</span>)</div><div class="line">        <span class="variable">$t_BITMAPDATA</span> = _GDIPlus_BitmapLockBits(<span class="variable">$h_Bitmap</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="variable">$i_Width</span>, <span class="variable">$i_Height</span>, <span class="variable">$GDIP_ILMREAD</span>, <span class="variable">$GDIP_PXF24RGB</span>)</div><div class="line">        </div><div class="line">        <span class="variable">$i_Stride</span> = DllStructGetData(<span class="variable">$t_BITMAPDATA</span>, <span class="string">"Stride"</span>);Stride - Offset, in bytes, between consecutive scan lines of the bitmap. <span class="keyword">If</span> the stride is positive, the bitmap is top-down. <span class="keyword">If</span> the stride is negative, the bitmap is bottom-up.</div><div class="line">        <span class="variable">$p_Scan</span> = DllStructGetData(<span class="variable">$t_BITMAPDATA</span>, <span class="string">"Scan0"</span>);Scan0 - Pointer to the first (index <span class="number">0</span>) scan line of the bitmap.</div><div class="line">        </div><div class="line">        <span class="variable">$t_PIXEDATA</span> = DllStructCreate(<span class="string">"ubyte lData["</span> &amp; (Abs(<span class="variable">$i_Stride</span>) * <span class="variable">$i_Height</span>) &amp; <span class="string">"]"</span>, <span class="variable">$p_Scan</span>)</div><div class="line">        </div><div class="line">        <span class="variable">$s_PIXEDATA</span> = StringTrimLeft(DllStructGetData(<span class="variable">$t_PIXEDATA</span>, <span class="string">"lData"</span>), <span class="number">2</span>);去掉头部<span class="string">"0x"</span></div><div class="line">        _GDIPlus_BitmapUnlockBits(<span class="variable">$h_Bitmap</span>, <span class="variable">$t_BITMAPDATA</span>)</div><div class="line"> </div><div class="line">        <span class="keyword">If</span> <span class="variable">$b_Array2d</span> Then;要求返回二维数组</div><div class="line">                Local <span class="variable">$a_Ret</span>[<span class="variable">$i_Height</span>][<span class="variable">$i_Width</span>], <span class="variable">$i_X</span>, <span class="variable">$i_Y</span>, <span class="variable">$s_Temp</span></div><div class="line">                <span class="keyword">For</span> <span class="variable">$i_Y</span> = <span class="number">0</span> To <span class="variable">$i_Height</span> - <span class="number">1</span></div><div class="line">                        <span class="variable">$s_Temp</span> = StringMid(<span class="variable">$s_PIXEDATA</span>, <span class="variable">$i_Y</span> * (<span class="variable">$i_Stride</span> * <span class="number">2</span>) + <span class="number">1</span>, <span class="variable">$i_Width</span> * <span class="number">6</span>)</div><div class="line">                        <span class="variable">$a_Match</span> = StringRegExp(<span class="variable">$s_Temp</span>, <span class="string">"\w{6}"</span>, <span class="number">3</span>)</div><div class="line">                        <span class="keyword">For</span> <span class="variable">$i_X</span> = <span class="number">0</span> To <span class="variable">$i_Width</span> - <span class="number">1</span></div><div class="line">                                <span class="variable">$a_Ret</span>[<span class="variable">$i_Y</span>][<span class="variable">$i_X</span>] = Number(<span class="string">"0x"</span> &amp; <span class="variable">$a_Match</span>[<span class="variable">$i_X</span>])</div><div class="line">                        Next</div><div class="line">                Next</div><div class="line">        <span class="keyword">Else</span>;要求返回一维数组</div><div class="line">                Local <span class="variable">$a_Ret</span>[<span class="variable">$i_Height</span>], <span class="variable">$i_Y</span></div><div class="line">                <span class="keyword">For</span> <span class="variable">$i_Y</span> = <span class="number">0</span> To <span class="variable">$i_Height</span> - <span class="number">1</span></div><div class="line">                        <span class="variable">$a_Ret</span>[<span class="variable">$i_Y</span>] = StringMid(<span class="variable">$s_PIXEDATA</span>, <span class="variable">$i_Y</span> * (<span class="variable">$i_Stride</span> * <span class="number">2</span>) + <span class="number">1</span>, <span class="variable">$i_Width</span> * <span class="number">6</span>)</div><div class="line">                Next</div><div class="line">        <span class="keyword">EndIf</span></div><div class="line">        <span class="keyword">Return</span> <span class="variable">$a_Ret</span></div><div class="line">EndFunc   ;==&gt;Bitmap2Array</div><div class="line"> </div><div class="line">Func _MouseClick(<span class="variable">$hWnd</span>, <span class="variable">$x</span>, <span class="variable">$y</span>, <span class="variable">$button</span> = <span class="string">'left'</span>, <span class="variable">$times</span> = <span class="number">1</span>, <span class="variable">$delay</span> = <span class="number">250</span>)</div><div class="line">        Local <span class="variable">$iX</span></div><div class="line">        Local <span class="variable">$lParam</span> = BitOR(BitAND(<span class="variable">$x</span>, <span class="number">0xFFFF</span>), <span class="variable">$y</span> * <span class="number">0x10000</span>)</div><div class="line">        <span class="variable">$button</span> = StringLower(<span class="variable">$button</span>)</div><div class="line">        <span class="keyword">If</span> <span class="variable">$button</span> = <span class="string">"left"</span> Then</div><div class="line">                <span class="keyword">For</span> <span class="variable">$iX</span> = <span class="number">1</span> To <span class="variable">$times</span></div><div class="line">                        _PostMessage(<span class="variable">$hWnd</span>, <span class="number">0x200</span>, <span class="number">0</span>, <span class="variable">$lParam</span>);WM_MOUSEMOVE</div><div class="line">                        _PostMessage(<span class="variable">$hWnd</span>, <span class="number">0x201</span>, <span class="number">1</span>, <span class="variable">$lParam</span>);WM_LBUTTONDOWN</div><div class="line">                        _PostMessage(<span class="variable">$hWnd</span>, <span class="number">0x202</span>, <span class="number">0</span>, <span class="variable">$lParam</span>);WM_LBUTTONUP</div><div class="line">                        <span class="keyword">If</span> <span class="variable">$iX</span> &lt; <span class="variable">$times</span> Then Sleep(<span class="variable">$delay</span>)</div><div class="line">                Next</div><div class="line">        <span class="keyword">ElseIf</span> <span class="variable">$button</span> = <span class="string">"right"</span> Then</div><div class="line">                <span class="keyword">For</span> <span class="variable">$iX</span> = <span class="number">1</span> To <span class="variable">$times</span></div><div class="line">                        _PostMessage(<span class="variable">$hWnd</span>, <span class="number">0x200</span>, <span class="number">0</span>, <span class="variable">$lParam</span>);WM_MOUSEMOVE</div><div class="line">                        _PostMessage(<span class="variable">$hWnd</span>, <span class="number">0x204</span>, <span class="number">2</span>, <span class="variable">$lParam</span>);WM_RBUTTONDOWN</div><div class="line">                        _PostMessage(<span class="variable">$hWnd</span>, <span class="number">0x205</span>, <span class="number">0</span>, <span class="variable">$lParam</span>);WM_RBUTTONUP</div><div class="line">                        <span class="keyword">If</span> <span class="variable">$iX</span> &lt; <span class="variable">$times</span> Then Sleep(<span class="variable">$delay</span>)</div><div class="line">                Next</div><div class="line">        <span class="keyword">EndIf</span></div><div class="line">EndFunc   ;==&gt;_MouseClick</div><div class="line"> </div><div class="line">Func _PostMessage(<span class="variable">$hWnd</span>, <span class="variable">$iMsg</span>, <span class="variable">$iwParam</span>, <span class="variable">$ilParam</span>)</div><div class="line">        DllCall(<span class="string">"user32.dll"</span>, <span class="string">"bool"</span>, <span class="string">"PostMessage"</span>, <span class="string">"hwnd"</span>, <span class="variable">$hWnd</span>, <span class="string">"uint"</span>, <span class="variable">$iMsg</span>, <span class="string">"wparam"</span>, <span class="variable">$iwParam</span>, <span class="string">"lparam"</span>, <span class="variable">$ilParam</span>)</div><div class="line">EndFunc   ;==&gt;_PostMessage</div><br></code></pre></td></tr></table></figure>




      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/笔记/">笔记</a>, <a href="/categories/笔记/转载/">转载</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/Autoit/">Autoit</a>, <a href="/tags/游戏/">游戏</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</div></div>
    <aside id="sidebar" class="alignright">
<div class="search">
  <form action="http://google.com/search" method="get" accept-charset="utf-8">
    <input type="text" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:alantr.tk">
  </form>
</div>


<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/历程/">历程</a><small>1</small></li>
  
    <li><a href="/categories/娱乐/">娱乐</a><small>1</small></li>
  
    <li><a href="/categories/笔记/">笔记</a><small>2</small></li>
  
    <li><a href="/categories/笔记/转载/">转载</a><small>1</small></li>
  
  </ul>
</div>



<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/Autoit/">Autoit</a><small>1</small></li>
  
    <li><a href="/tags/From-Youtube/">From Youtube</a><small>1</small></li>
  
    <li><a href="/tags/Git/">Git</a><small>1</small></li>
  
    <li><a href="/tags/其实我是来测试的/">其实我是来测试的</a><small>2</small></li>
  
    <li><a href="/tags/好玩的视频/">好玩的视频</a><small>1</small></li>
  
    <li><a href="/tags/游戏/">游戏</a><small>1</small></li>
  
    <li><a href="/tags/版本控制/">版本控制</a><small>1</small></li>
  
    <li><a href="/tags/音乐/">音乐</a><small>1</small></li>
  
  </ul>
</div>


<a class="bshareDiv" href="http://www.bshare.cn/share">分享按钮</a><script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/buttonLite.js#uuid=6d0815d6-d5ed-40e3-b3a4-b6fd5af95db4&amp;style=3&amp;fs=4&amp;textcolor=#fff&amp;bgcolor=#19D&amp;text=分享到"></script>

<iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=3016098621&verifier=655ac839&dpc=1"></iframe>
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2013 AlanTR
  
</div>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'alantr';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>